\section{Introduction}
% Computer Society journal papers do something a tad strange with the very first
% section heading (almost always called "Introduction"). They place it ABOVE the
% main text! IEEEtran.cls currently does not do this for you.  However, You can
% achieve this effect by making LaTeX jump through some hoops via something
% like:
%
%\ifCLASSOPTIONcompsoc \noindent\raisebox{2\baselineskip}[0pt][0pt]%
%{\parbox{\columnwidth}{\section{Introduction}\label{sec:introduction}%
%\global\everypar=\everypar}}% \vspace{-1\baselineskip}\vspace{-\parskip}\par
%\else \section{Introduction}\label{sec:introduction}\par \fi
%
% Admittedly, this is a hack and may well be fragile, but seems to do the trick
% for me. Note the need to keep any \label that may be used right after \section
% in the above as the hack puts \section within a raised box.



% The very first letter is a 2 line initial drop letter followed by the rest of
% the first word in caps (small caps for compsoc).
% 
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
% 
% form to use if you need the single drop letter followed by normal text
% (unknown if ever used by IEEE): \IEEEPARstart{A}{}demo file is ....
% 
% Some journals put the first two words in caps: \IEEEPARstart{T}{his demo} file
% is ....
% 
% Here we have the typical use of a "T" for an initial drop letter and "HIS" in
% caps to complete the first word.
%\IEEEPARstart{T}{his}

At 6:15 pm on the 3rd of January, 2009 UTC Satoshi Nakamoto (likely a pseudonym) created and announced a block of data known as the `Genesis Block' of the Bitcoin block chain\cite{satoshi}. With this block, the first 50 units of the decentralized peer to peer currency, Bitcoin, were created.  Now over ten million bitcoins have been generated.

\textcite{euro-currency-schemes} describes three different currency schemes: ``Closed currency schemes'', ``Currency  schemes with unidirectional flow'' and ``Currency schemes with  bidirectional flow''. Bitcoin is classified as the third type - because  with currency exchange systems it is possible to convert bitcoin to fiat  currency for example: they are currently trading at \input{price}.
%TODO:This would be better structured as: three different currency schemes: currency1 with unidirectional flow e.g. blah; currency 2 e.g. blah2 or currency 3 which includes Bitcoin.  Bitcoin counts as currency3 because....


Bitcoin is distinct from other bidirectional digital currency schemes such as central banking and financial institutions or money transfer systems such as PayPal\cite{paypal} ``it is neither created nor administered by a single authority such as a central bank''\cite{why-interesting}, transactions are also irreversible and transactions can be made pseudo-anonymously.  The bitcoin protocol allows multiple different clients to connect, verify and disseminate transactions.  The reference bitcoin client, has received multiple releases\footnote{\url{http://bitcoin.org/en/version-history##0.5.0}} and is now known as Bitcoin-Qt\cite{bitcoin-qt}.


\begin{itemize} \item The need for bitcoin \item What this paper is about - The
    research on bitcoin, which has focussed on Anonymity, Economics and
    proposals for improvements \end{itemize}

\section{Background}
The core of any currency is to allow users to participate in transactions that result in the transfer of value between the participants.  Such a system requires an element of trust or protocols that remove the need for trust between the participants.  If a user, Alice wishes to send some value to Bob, Bob will need to know that Alice has the funds to send that transaction and has not sent that money to anyone else (a double spend). This problem is easily solvable using a physical transferable good where the expense to duplicate or create more of a resource can be ensured to be more than the value of the item: for example creating counterfeit paper currency or creating a commodity like gold.  Although the issue of trust is somewhat negated with physical goods, they also encounter a separate issue - moving that value over distance.  This can be an expensive exercise as it requires both the expense of physically moving the good - particularly an issue with heavy gold bars - as well as the cost of securing it during transportation. While paper currencies solve these problems somewhat, with a trade-off of making duplication easier, a digital currency aims to recreate the difficulty in duplication, while taking advantage of the ease of transfer that digital information brings.

Up until relatively recently, discussions in scientific literature surrounding currency systems have assumed the necessity of some type of trusted central authority or authorities as part of the operation of the protocol.  These authorities usually maintain a record of transactions performed as well as minting and controlling currency.  However, the success of Bitcoin has shown that this assumption is not necessarily the case and has increased discussion into decentralised currency - moving it from a topic of intellectual curiosity to one with more practical implications.

\subsection{Central Banking Authorities}
Services such as the UK ``Faster Payments Service''~\cite{guardian-fps}, or the ``Single Euro Payments Area'' (SEPA) payments initiative~\cite{SEPA} operate as a transfer protocol between users of trusted entities such as banks and other financial institutions.  While, payment processor systems and services, such as PayPal\footnote{\url{https://www.paypal.com/uk/webapps/mpp/transfer-money-online}}, Dwolla\footnote{\url{https://www.dwolla.com/individuals}} and Liberty Reserve\footnote{\url{http://web.archive.org/web/20130430103158/http://www.libertyreserve.com/}} operate on-top of existing currencies and, in exchange for money sent using SEPA or bank transfer, allow accounts to be credited with the equivalent value.  When a user requests a value transfer one account is debited while another is credited~\cite{paypal}.

While there is a legal distinction between financial institutions and payment processors there is technically no  significant difference.  These systems are effectively fully centralized, digital systems of exchange, in which only the central authority or authorities control the minting of the currency or are able to create transactions - an individual cannot create transactions, they must rely on a central authority to make the transaction on their behalf.

These fully centralized systems have a simple design and implementation, however, during the operation of these systems some key disadvantages for the users have become apparent: the trusted entities have a legal responsibility to handle ``charge-backs'' or reverse transactions, the cost for this escrow service is placed on the customer as a transfer fee or to the merchant as a fine. The second major disadvantage of these systems is that they are liable to be closed down due to legal pressure~\cite{lr-shutdown}, or individual users' accounts can be frozen~\cite{mtgox-dwolla,vlad:mtgox-dwolla}.

These fully centralized systems have a simple design and implementation however, there are some key issues that affect the users of the system - both merchants and customers - two of which are discussed here.  

The first issue is that the trusted entity has a legal responsibility to handle ``charge-backs'' or reverse transactions, the cost for this escrow service - in which the central authority acts as an arbiter in disputes - is placed on the customer as a transfer fee or to the merchant as a fine, or worse\footnote{\url{http://www.guardian.co.uk/world/2012/jan/04/paypal-buyer-destroys-violin}}.

The  second major disadvantage of a centralised system is that it allows for  a single point of failure resulting in a lack of reliability from the  perspective of the user.  The central authority has complete control over the status of the users' account - that authority can freeze the funds of that account at their discretion according to their own terms of service, this can include pressure from legal authorities~\cite{mtgox-dwolla,vlad:mtgox-dwolla,wikileaks-paypal}.  Additionally, the central authority exists as an easier target for legal action, should that authority fail to freeze or track `problematic' accounts and this may result in a total shut down of that service~\cite{lr-shutdown,egold-shutdown}.

\subsection{Unique Token}\textcite{netcash} discuss one solution, NetCash, this protocol uses a unique token held by both the central authority and the owner of the coin. To create currency the user and central authority agree on a unique token in exchange for some currency or resource. When that user wishes to transact value to another, they simply send the token to the other user.  To verify that the transaction is legitimate, other receiving users send the token to the exchange, to be swapped for a new spendable token meaning the original token can no longer be spent. One issue with this protocol is the central authority cannot be independently verified, as such the authority could choose to deny knowledge of
a token, or allow multiple users to claim the same token.


\subsection{Blind-signed Chaum Tokens}
Proposed by \textcite{chaum}, the Chaum Token protocol, uses blind signatures: messages signed by a central authority in exchange for a fee of some currency or other resource. This messages can be converted into a token unrelated to the message except for the fact that the signing server can verify that the token has indeed been signed previously, this has the advantage that the central authority cannot discover the original owner of a signed message when cashed by a payee.  This protocol, however, maintains the very same issues as NetCash: the central authority can deny knowledge of a token, or arbitrarily mint new tokens without a fee.


\subsection{B-Money digital signature chain}\label{digital-sig}
An alternative solution, B-Money proposed by~\textcite{b-money}. Uses a chain of digital signatures where transaction messages are created using public key cryptography and the chain of digital signatures can be traced back to the original creation of the unit of value.

``If Alice (owner of pseudonym $K_A$) wishes to transfer X units of money to Bob (owner of pseudonym $K_B$), she broadcasts the message ``I give X units of money to $K_B$'' signed by $K_A$'' for example see Figure~\ref{fig:chain-spend}.

This system presents the same problems as before regarding value distribution and potential double spending i.e. how does Bob know that Alice has the value to start with and how does Bob know that this value hasn't already been spent, see Figure~\ref{fig:chain-double-spend} for an example double spend. \textcite{b-money} proposes two solutions to this problem: using a theoretical ``synchronous and unjammable anonymous broadcast channel''


In b-money~\cite{b-money} the solution is to involve multiple trusted authorities that host a public copy of every transaction sent.

\begin{figure}[htb]
    \centering
    \includegraphics[width=\columnwidth]{img/Bitcoin_Transaction_Visual}
    \caption{A chain of digital signatures representing value transfer.
    (source \protect\cite{satoshi})}
    \label{fig:chain-spend}
\end{figure}

\begin{figure}[htb]
    \centering
    \includegraphics[width=\columnwidth]{img/Bitcoin_DoubleSpend_Visual}
    \caption{A chain of digital signatures representing value transfer with a double spend: Without some consensus system ``User 2'' is not prevented from sending the same value to both ``Owner 3'' and ``Owner 4''.
    (based on work from \protect\cite{satoshi})}
    \label{fig:chain-double-spend}
\end{figure}


Bob can verify that Alice was given some value from a chain of transactions leading back to the central authority where the value is assumed to be created and can subtract the total value of Alice's spent transactions to determine if the transaction sent to Bob is valid.  While this system prevents any central authority from forcing a user to spend money, unlike token based digital currencies or central banking, the central authorities still requires some degree of trust from the user that the authority is both benign and secure. For example the central authority could cooperate with, or more simply act as, a user attempting to achieve a double payment attack by showing different views to different users.


In systems where some trusted central authority exists, while it may be reasonable to trust some agent for the purpose of authenticating the ownership of value, that authority may act in a way outside of the agents' control.  The server hosting the system could be compromised either through technical means or through the
use of force, as in the case of E-Gold.

\begin{itemize} \item Show different views to different users, resulting in a
        double spend \item Allocate money unfairly or unexpectedly, with
        excessive minting or ``easing'' \item Be shut down by a government \item
        Cryptographic signing \item Transactions as cryptographic signatures
        \item The double spending problem \item HashCash \end{itemize}

\section{The Bitcoin Protocol}
In Bitcoin \textcite{satoshi} makes very few changes to the original b-money\cite{b-money} specification.  The vast majority of the Bitcoin protocol is identical to b-money except for one novel proposal: to create a transaction ordering consensus by augmenting the group of central authorities with a distributed, decentralized time stamp server that is used to agree on the order that transactions occurred in.  Any user can, on receipt of a transaction, query the time stamp server and determine if that transaction has been invalidated by a prior transaction. This key difference is likely the reason that Bitcoin took crypto-currencies from mathematical curiosity to a usable system for store and transfer of value.

\subsection{Distributed Transaction Validation}
The time stamp server creates a chain of blocks of transactions, each referring to the previous by hash value.  The transactions to be included in the chain are discovered when peers broadcast them into a peer discovery network that operates in a similar manner to a BitTorrent swarm.  Any user can contribute to this chain of blocks, but before another peer will relay it to others, it must meet a ``proof-of-work'' requirement: the SHA256 hash value of each block must not exceed a value determined by the current `difficulty'.  Because the SHA2 hashing function has been designed such that the value of an amount of data is unpredictable and evenly distributed in the range of the function, the only way for a participant to create data with a hash value below the difficulty limit is to repeatedly try different input data values\footnote{\url{http://blog.ezyang.com/2011/06/the-cryptography-of-bitcoin/}}: ``The average work required is exponential in the number of zero bits required and can be verified by executing a single hash''~\cite{satoshi}. Transaction block data can be altered without changing the transaction semantics because the block format includes a `nonce' field for this purpose.


Because each block refers to the previous block, ``To modify a past block, an attacker would have to redo the proof-of-work of the block and all blocks after it''.  As more blocks are created the more expensive it is for any group to alter the consensus reached by the peer network.  Because the proof of work system is computationally expensive an incentive, other than the increased certainty of any transaction a user has previously received will remain valid, is included.  While all the transactions included in a block must have at least the input value as output value, one transaction can be included with no input and an output dependent on the total number of blocks due to halve every 4 years. Currently this reward is 25 bitcoins. This reward is paid for by the consensual deflation of every participants held bitcoin. This process also serves to solve the distribution problem of digital currencies.

\begin{itemize} \item Public keys and addresses.  \item How bitcoin aims to
        solve the double spending problem without a central authority \item
            Bitcoin clients present public keys to the user as ``addresses'',
            these are the result of the hash of a public key and a checksum.
            Similar in purpose as the Luhn check on credit cards, this process
        is used to reduce the likelihood of losing bitcoin to a public key with
    no paired private key by preventing mistakes when entered into clients by
hand.  \item Transaction types \item Change address.  The change address is
always a new address \item TestNet bitcoin \end{itemize}


\subsection{The Bitcoin block-chain is not strictly a consensus protocol}
\textcite{bitcoin-impossible} notes that, strictly, the Bitcoin proof of work block-chain is not a consensus scheme. In distributed consensus protocols, consensus is arrived at when some sufficient number of members of the group agree. This is impossible to achieve in a distributed system where this group is not known: agents are constantly joining and leaving the group in a way that prevents Sybil attacks. By declaring the Bitcoin group consensus definition as ``all the computing power in existence'' consensus is only achieved once more than half of the compute power in existence is used in the proof of work system. Therefore the Bitcoin system is only Sybil \emph{resistant}. The Bitcoin systems is also not fully decentralized, a set of core developers, now the Bitcoin Foundation, have some control of the protocol: two major disruptions to the network have been solved using manual intervention from this group: on 15 August 2010 an integer overflow was discovered in the Bitcoin protocol this vulnerability ``allows remote attackers to bypass intended economic restrictions and create many bitcoins via a crafted Bitcoin transaction.''~\cite{CVE-2010-5139}. The second, where the network segmented into clients with two differing consensus results~\cite{CVE-2013-3220,glitch-report,major-glitch}. Users of the network are still free to ignore the advice of this group.

\section{Related Work}
TODO: Related work, not covered in this report: Mentions of legal and economics papers eg. red-balloons \cite{red-balloons}.


\section{Anonymity} As part of the Bitcoin protocol, all transactions must be broadcast publicly however, \textcite{satoshi} maintains that ``privacy can still be maintained by breaking the flow of information [...] by keeping public keys anonymous''.  Each Bitcoin address can be considered one pseudonym of many of the owner of the associated private key, because each person can own multiple Bitcoin addresses in a wallet. \textcite{satoshi} asserts that because of this disconnect between user and address it is difficult to associate a particular transaction with a particular user.


\subsection{Taint Analysis} \textcite{reid-anon}, considers the feasibility of maintaining this pseudo-anonymity in practise, by investigating the multiple input semantics of the Bitcoin transaction format. 


\textcite{reid-anon} argue that any key taking part in this process was in a single wallet, and thus owned by a single user. Therefore by combining the knowledge of how keys are grouped into wallets with knowledge from outside the protocol other inferences can be made, with the aim to determine the identity of the user behind the wallet, and thus any transactions made.


\textcite{reid-anon} aim to de-anonymize a user using two phases.  First to contract the publicly available, as published in the blockchain, ``transaction network'' to a ``user network'' by determining groups of addresses that appear to behave as part of a single wallet.  The second phase is to  link that group using publicly available ``Off-Network Information'' linking addresses to keys, eg by crawling the web for forum posts with including both user-names and addresses.


Multi-input transactions are used to distinguish the behavior of a group of keys from any other in the transaction network.  \textcite{eval-priv} add to this a further heuristic of ``Shadow Addresses'' to associate newly created addresses with users.

\subsubsection{Multi-input Transactions}
In the Bitcoin transaction format, if a user cannot fulfil the value of a transaction by spending a single previous output, the client will combine multiple inputs, or previous outputs, where the user has the ability to fulfil their spend conditions.  When combined the Bitcoin client must fulfil the spend conditions of all of the outputs, usually the conditions result in the requirement to sign the transaction with all of the participating private keys.  ``It is therefore straightforward to conclude that if these BTCs are (spendable) by different addresses, then the input addresses belong to the same user''\cite{eval-priv}.

[diagram of multi input transactions grouping wallets]

\subsubsection{``Shadow'' Addresses}


\begin{itemize} \item Briefly mentions mixers and ``repeatedly sending fractions
        of their Bitcoins to themselves using multiple (newly generated)
    public-keys'' Although that does not defeat taint analysis as these can be
assumed to be owned by the originating wallet until otherwise linked.  \item
    Change addresses, bug that lead to them being in the same position each
    time.  Androulaki et al, note that change addresses are clearly
    distinguishable by being the only newly generated address in the output of
    the transaction.  However it is recommended to newly generate a Bitcoin
    address for each receiving transaction.  \end{itemize}


\subsection{Taint Analysis Disruption}
TODO: expand below sections:
\textcite{reid-anon} suggest repeatedly sending coins to new addresses. While this would gain anonymity under the reasoning of the paper, a new heuristic for addresses that have not yet been spent to inherit the status of the addresses that sent to it.


\subsubsection{Fully Trusted Mixing}
\textcite{eval-priv} note that it is possible to use a mixing service to fully disrupt their analysis.


\subsubsection{ZeroCoin} \textcite{zerocoin} propose a solution to the de-anonymization proposed in taint analysis, by defining new transaction types that take advantage of zero knowledge proofs.

\subsubsection{Multi-Input Transaction}
\subsubsection{In-Protocol Mixing}
In his forum post, ``I taint rich!'', Bitcoin developer Gregory (gmaxwell) Maxwell describes a process to disrupt ``brain-dead automated (taint) analysis''.  Because the conditions of a set of previous outputs can be fulfilled partially, multiple users can cooperate to create a single transaction that causes their public keys to appear linked in a single wallet to taint analysis, without revealing their private keys to the group.  As such the claim made by \textcite{satoshi}, and key assumption made by \textcite{reid-anon}, that ``Some linking is still unavoidable with multi-input transactions, which necessarily reveal that their inputs were owned by the same user'' is wrong.


While in the example described it is clear how the addresses are truly linked in the user graph, due to the cooperation being performed on a public forum, the same address used on the input and output and the fact that that address is the vanity address, ``1gmaxw''. The complexity of this process means it is not well used.


For a serious attempt to disrupt taint analysis the taint disrupting transaction must have the following properties:  Each output must be to an address that has not been used previously. There must be an equal number of bitcoin sent to each output. The transaction must not be traceable to a network address.  The communication during cooperation must not be intercepted. The communication must not be shown to have taken place.  At this point, from a view of the block chain, the two wallets appear linked, under the multi-transaction heuristic and change address heuristic. From the view of the cooperating peers, however, it is clear the true owner of the output keys as such this process must take place repeatedly between many different peers.

\begin{itemize} \item Using the Tor hidden service \item Some sort of central or
        distributed registration system for peers \item A peer may connect to
            any other peer, each peer creates a new address, they both determine
            an equal amount of bitcoin to send. And create a multi-input
            transaction from both users, split equally into the new addresses.
\item Assuming that the ownership of originating addresses was known publicly
the ownership of the two new addresses is now 50/50.  \item Diagram \item Repeat
the process \end{itemize}


\section{Conclusion}
While it is clear that the de-anonymization techniques will be no-longer be applicable once the anonymization techniques discussed in this report become widely used by users of the Bitcoin system, it is not obvious that they will be applicable even to existing network data. Any adversary well versed in the protocol would have been able to avoid de-anonymization even before the Bitcoin client\cite{bitcoin-qt} added support for multi-input and output transactions and the dangers of address re-use were widely publicized because these techniques were already available when interacting with the network directly with command line tools.


\section{Future Work}
This report discusses only a proposal for a novel anonymization system, an obvious avenue for further work would be to design, create and test a concrete implementation. Other avenues for further work would to be to investigate design changes and improvements to the existing Bitcoin system: would using multi-cast for transaction distribution enhance the protocol; create tools to allow easy data-mining of block-chain data using ideas from the Linked Open Data or Semantic Web communities.

\section{Alternative Post-Bitcoin Digital Currencies}

\subsection{Bitcoin-like protocols}
TODO: What makes a protocol different to Bitcoin? Why is this important?

\subsubsection{Upgrades and Maintenance}
TODO: Bitcoin foundation, not strictly devoid of authority.

\subsection{Improvements and Differences}
TODO: Litecoin, Feathercoin. Why not Ripple?

\begin{itemize} \item What is a forking change?  \item What improvements are
possible \item The hash power voting system \end{itemize}


% An example of a floating figure using the graphicx package.  Note that \label
    % must occur AFTER (or within) \caption.  For figures, \caption should occur
    % after the \includegraphics.  Note that IEEEtran v1.7 and later has special
    % internal code that is designed to preserve the operation of \label within
    % \caption even when the captionsoff option is in effect. However, because
    % of
% issues like this, it may be the safest practice to put all your \label just
    % after \caption rather than within \caption{}.
%
% Reminder: the "draftcls" or "draftclsnofoot", not "draft", class option should
    % be used if it is desired that the figures are to be displayed while in
    % draft mode.
%
%\begin{figure}[!t] \centering \includegraphics[width=2.5in]{myfigure} where an
    %.eps filename suffix will be assumed under latex, and a .pdf suffix will be
    %assumed for pdflatex; or what has been declared via
    %\DeclareGraphicsExtensions.  \caption{Simulation Results.} \label{fig_sim}
    %\end{figure}

% Note that IEEE typically puts floats only at the top, even when this results
    % in a large percentage of a column being occupied by floats.  However, the
    % Computer Society has been known to put floats at the bottom.


% An example of a double column floating figure using two subfigures.  (The
    % subfig.sty package must be loaded for this to work.) The subfigure \label
    % commands are set within each subfloat command, and the \label for the
    % overall figure must come after \caption.  \hfil is used as a separator to
    % get equal spacing.  Watch out that the combined width of all the
    % subfigures on a line
% do not exceed the text width or a line break will occur.
%
%\begin{figure*}[!t] \centering \subfloat[Case
    %I]{\includegraphics[width=2.5in]{box}% \label{fig_first_case}} \hfil
    %\subfloat[Case II]{\includegraphics[width=2.5in]{box}%
    %\label{fig_second_case}} \caption{Simulation results.} \label{fig_sim}
    %\end{figure*}
%
% Note that often IEEE papers with subfigures do not employ subfigure captions
    % (using the optional argument to \subfloat[]), but instead will
    % reference/describe all of them (a), (b), etc., within the main caption.


% An example of a floating table. Note that, for IEEE style tables, the \caption
    % command should come BEFORE the table. Table text will default to
    % \footnotesize as IEEE normally uses this smaller font for tables.  The
    % \label must come after \caption as always.
%
%\begin{table}[!t] % increase table row spacing, adjust to taste
    %\renewcommand{\arraystretch}{1.3} if using array.sty, it might be a good
    %idea to tweak the value of \extrarowheight as needed to properly center the
    %text within the cells \caption{An Example of a Table} \label{table_example}
    %\centering % Some packages, such as MDW tools, offer better commands for
%making tables % than the plain LaTeX2e tabular which is used here.
    %\begin{tabular}{|c||c|} \hline One & Two\\ \hline Three & Four\\ \hline
    %\end{tabular} \end{table}


% Note that IEEE does not put floats in the very first column - or typically
    % anywhere on the first page for that matter. Also, in-text middle ("here")
    % positioning is not used. Most IEEE journals use top floats exclusively.
    % However, Computer Society journals sometimes do use bottom floats - bear
    % this in mind when choosing appropriate optional arguments for the
    % figure/table
% environments.  Note that, LaTeX2e, unlike IEEE journals, places footnotes
    % above bottom floats. This can be corrected via the \fnbelowfloat command
    % of the stfloats package.